<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MainCpu Software Documentation: Gantry Device Implementation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="Stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MainCpu Software Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Gantry Device Implementation<div class="ingroups"><a class="el" href="group___g_a_n_t_r_y___d_e_v_i_c_e___i_n_t_e_r_f_a_c_e.html">Gantry Device Communication modules</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="classdevice_class.html">deviceClass</a> class.  
</p>
<p >The <a class="el" href="classdevice_class.html">deviceClass</a> class. </p>
<p >This class implements the communication protocol for the Gantry Devices.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
General Description</h1>
<p >The class implements the specification of the device protocol communication.</p>
<p >In particolar:</p>
<ul>
<li>The device provides a Parameter list array;</li>
<li>The device provides a Data list array;</li>
<li>The device provides a Status list array;</li>
<li>The device provides APIs to handle the data handling;</li>
<li>The device provides API's to handle the Device Command Execution.</li>
</ul>
<blockquote class="doxtable">
<p >&zwj;NOTE: The Device Class is in the same thread of the MAIN application! </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md2"></a>
Status Registers Handling</h1>
<p >The Device provides a list of basic Status registers. As for the protocol specification, the first two Status registers shall be reserved for:</p><ul>
<li>Address 0: reserved;</li>
<li>Address 1: SYSTEM REGISTER;</li>
<li>Address 2: ERROR REGISTER;</li>
<li>Address 3: COMMAND REGISTER;</li>
</ul>
<p >The Class subclassing the base class shall use the API <em><b>addStatusRegister()</b></em> in order to add extra registers in the list.</p>
<p >The application implementing a Device can read a Status register using the convenient API <em><b>downloadStatus(seq, index)</b></em></p>
<p >The function sends the READ STATUS formatted frame to the device with the application seq number. After the function is used the Status register changes its internal status to _DEVREG_PENDING until the Device acknowledges the request with the actual register data content.</p>
<p >Excluding the special registers, for the custom device status register the Application:</p><ul>
<li>emit the signal statusChangedSgn(index) if the Status register content changes;</li>
<li>emit the signal sequenceSgn(seq) always the command completes;</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Data Registers Handling</h1>
<p >The Data registers are Device's registers that the Application modifies runtime to control the behavior of the Device.</p>
<p >The Data registers are Read Only for the Device and Read/Write for Application.</p>
<p >The Application can Write the Data register with the function <em><b>uploadData()</b></em></p>
<p >When the application request to write a Data register, its internal status changes in _DEVREG_PENDING, until the Device acknowledges the request with the actual register data content.</p>
<p >When the device acknowledges the request, a signal <em><b>sequenceSgn()</b></em> is emitted.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Parameter Registers Handling</h1>
<p >The Parameter registers are Device's registers that sets the way the Device behaves. The Parameters differ from the Data registers because they can be stored in the Device non volatile memory and retriven at startup time.</p>
<p >The Application should change the Parameters only during system configuration.</p>
<p >The Parameter registers are Read Only for the Device and Read/Write for Application.</p>
<p >The Application can Write a Data register with the function <em><b>uploadParam()</b></em>. The Application can Store in non volatile memory a single Parameter register or the whole parameter list with the function <em><b>storeParam()</b></em>.</p>
<p >When the application request to write a Parameter register, its internal status changes in _DEVREG_PENDING, until the Device acknowledges the request with the actual register data content.</p>
<p >In either cases on which the Application request a Write Parameter or Store Parameter, when the device acknowledges the request, a signal <em><b>sequenceSgn()</b></em> is emitted.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Command Execution</h1>
<p >The Device protocol provides a method to request the Device to execute a function.</p>
<p >The Application, in order to request a command execution, shall call the function <em><b>execCommand()</b></em>.</p>
<p >When the Device acknowledges the command, the Application emit the signal <em><b>execCmdSgn()</b></em> with the Sequence message, the message code processed and the current execution status:</p>
<ul>
<li>_EXECCMD_COMPLETED: the command has been istantly executed;</li>
<li>_EXECCMD_PROCESSING: the command is in process;</li>
<li>_EXECCMD_ERROR: the command cannot be executed because an error has been detected;</li>
</ul>
<p >In case the status should be _EXECCMD_PROCESSING, the application shall poll the special <em>COMMAND</em> register (address = 3) in order to detect the execution progress.</p>
<p >In case the <em>COMMAND</em> register <em>status</em> field should be _EXECCMD_COMPLETED or _EXECCMD_ERROR the Application will notify the command comletion event signaling the <em><b>execCmdSgn()</b></em> </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
